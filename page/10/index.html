<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>mrhy&#039;s blogs</title><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#3273dc"><meta name="application-name" content="mrhy&#039;s blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="msapplication-TileColor" content="#3273dc"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="mrhy&#039;s blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="mrhy的博客"><meta property="og:type" content="blog"><meta property="og:title" content="mrhy&#039;s blogs"><meta property="og:url" content="https://mrhy1996.github.io/"><meta property="og:site_name" content="mrhy&#039;s blogs"><meta property="og:description" content="mrhy的博客"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://mrhy1996.github.io/img/og_image.png"><meta property="article:author" content="mrhy"><meta property="article:tag" content="mrhy"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://mrhy1996.github.io"},"headline":"mrhy's blogs","image":["https://mrhy1996.github.io/img/og_image.png"],"author":{"@type":"Person","name":"mrhy"},"description":"mrhy的博客"}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="mrhy&#039;s blogs" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Mrhy1996/"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-04-22T12:02:21.000Z" title="2021/4/22 20:02:21">2021-04-22</time>发表</span><span class="level-item"><time dateTime="2021-04-23T13:28:51.000Z" title="2021/4/23 21:28:51">2021-04-23</time>更新</span><span class="level-item">19 分钟读完 (大约2788个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/java-sourcecode-reentrantlock/">ReentrantLock</a></h1><div class="content"><p>先贴一下源码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReentrantLock</span> <span class="keyword">implements</span> <span class="title">Lock</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">7373984872572414699L</span>;</span><br><span class="line">    <span class="comment">/** Synchronizer providing all implementation mechanics */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Sync sync;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Base of synchronization control for this lock. Subclassed</span></span><br><span class="line"><span class="comment">     * into fair and nonfair versions below. Uses AQS state to</span></span><br><span class="line"><span class="comment">     * represent the number of holds on the lock.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Sync</span> <span class="keyword">extends</span> <span class="title">AbstractQueuedSynchronizer</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">5179523762034025860L</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * Performs &#123;<span class="doctag">@link</span> Lock#lock&#125;. The main reason for subclassing</span></span><br><span class="line"><span class="comment">         * is to allow fast path for nonfair version.</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">lock</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * Performs non-fair tryLock.  tryAcquire is implemented in</span></span><br><span class="line"><span class="comment">         * subclasses, but both need nonfair try for trylock method.</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">nonfairTryAcquire</span><span class="params">(<span class="keyword">int</span> acquires)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">final</span> Thread current = Thread.currentThread();</span><br><span class="line">            <span class="keyword">int</span> c = getState();</span><br><span class="line">            <span class="keyword">if</span> (c == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (compareAndSetState(<span class="number">0</span>, acquires)) &#123;</span><br><span class="line">                    setExclusiveOwnerThread(current);</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (current == getExclusiveOwnerThread()) &#123;</span><br><span class="line">                <span class="keyword">int</span> nextc = c + acquires;</span><br><span class="line">                <span class="keyword">if</span> (nextc &lt; <span class="number">0</span>) <span class="comment">// overflow</span></span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">&quot;Maximum lock count exceeded&quot;</span>);</span><br><span class="line">                setState(nextc);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">tryRelease</span><span class="params">(<span class="keyword">int</span> releases)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> c = getState() - releases;</span><br><span class="line">            <span class="keyword">if</span> (Thread.currentThread() != getExclusiveOwnerThread())</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalMonitorStateException();</span><br><span class="line">            <span class="keyword">boolean</span> free = <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (c == <span class="number">0</span>) &#123;</span><br><span class="line">                free = <span class="keyword">true</span>;</span><br><span class="line">                setExclusiveOwnerThread(<span class="keyword">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            setState(c);</span><br><span class="line">            <span class="keyword">return</span> free;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">isHeldExclusively</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="comment">// While we must in general read state before owner,</span></span><br><span class="line">            <span class="comment">// we don&#x27;t need to do so to check if current thread is owner</span></span><br><span class="line">            <span class="keyword">return</span> getExclusiveOwnerThread() == Thread.currentThread();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">final</span> ConditionObject <span class="title">newCondition</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ConditionObject();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Methods relayed from outer class</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">final</span> Thread <span class="title">getOwner</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> getState() == <span class="number">0</span> ? <span class="keyword">null</span> : getExclusiveOwnerThread();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">final</span> <span class="keyword">int</span> <span class="title">getHoldCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> isHeldExclusively() ? getState() : <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">isLocked</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> getState() != <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * Reconstitutes the instance from a stream (that is, deserializes it).</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(java.io.ObjectInputStream s)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> java.io.IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">            s.defaultReadObject();</span><br><span class="line">            setState(<span class="number">0</span>); <span class="comment">// reset to unlocked state</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sync object for non-fair locks</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">NonfairSync</span> <span class="keyword">extends</span> <span class="title">Sync</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">7316153563782823691L</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * Performs lock.  Try immediate barge, backing up to normal</span></span><br><span class="line"><span class="comment">         * acquire on failure.</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">lock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (compareAndSetState(<span class="number">0</span>, <span class="number">1</span>))</span><br><span class="line">                setExclusiveOwnerThread(Thread.currentThread());</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                acquire(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">tryAcquire</span><span class="params">(<span class="keyword">int</span> acquires)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> nonfairTryAcquire(acquires);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sync object for fair locks</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">FairSync</span> <span class="keyword">extends</span> <span class="title">Sync</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">3000897897090466540L</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">lock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            acquire(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * Fair version of tryAcquire.  Don&#x27;t grant access unless</span></span><br><span class="line"><span class="comment">         * recursive call or no waiters or is first.</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">tryAcquire</span><span class="params">(<span class="keyword">int</span> acquires)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">final</span> Thread current = Thread.currentThread();</span><br><span class="line">            <span class="keyword">int</span> c = getState();</span><br><span class="line">            <span class="keyword">if</span> (c == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!hasQueuedPredecessors() &amp;&amp;</span><br><span class="line">                    compareAndSetState(<span class="number">0</span>, acquires)) &#123;</span><br><span class="line">                    setExclusiveOwnerThread(current);</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (current == getExclusiveOwnerThread()) &#123;</span><br><span class="line">                <span class="keyword">int</span> nextc = c + acquires;</span><br><span class="line">                <span class="keyword">if</span> (nextc &lt; <span class="number">0</span>)</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">&quot;Maximum lock count exceeded&quot;</span>);</span><br><span class="line">                setState(nextc);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Creates an instance of &#123;<span class="doctag">@code</span> ReentrantLock&#125;.</span></span><br><span class="line"><span class="comment">     * This is equivalent to using &#123;<span class="doctag">@code</span> ReentrantLock(false)&#125;.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ReentrantLock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        sync = <span class="keyword">new</span> NonfairSync();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Creates an instance of &#123;<span class="doctag">@code</span> ReentrantLock&#125; with the</span></span><br><span class="line"><span class="comment">     * given fairness policy.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fair &#123;<span class="doctag">@code</span> true&#125; if this lock should use a fair ordering policy</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ReentrantLock</span><span class="params">(<span class="keyword">boolean</span> fair)</span> </span>&#123;</span><br><span class="line">        sync = fair ? <span class="keyword">new</span> FairSync() : <span class="keyword">new</span> NonfairSync();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Acquires the lock.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;Acquires the lock if it is not held by another thread and returns</span></span><br><span class="line"><span class="comment">     * immediately, setting the lock hold count to one.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;If the current thread already holds the lock then the hold</span></span><br><span class="line"><span class="comment">     * count is incremented by one and the method returns immediately.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;If the lock is held by another thread then the</span></span><br><span class="line"><span class="comment">     * current thread becomes disabled for thread scheduling</span></span><br><span class="line"><span class="comment">     * purposes and lies dormant until the lock has been acquired,</span></span><br><span class="line"><span class="comment">     * at which time the lock hold count is set to one.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">lock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        sync.lock();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Acquires the lock unless the current thread is</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@linkplain</span> Thread#interrupt interrupted&#125;.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;Acquires the lock if it is not held by another thread and returns</span></span><br><span class="line"><span class="comment">     * immediately, setting the lock hold count to one.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;If the current thread already holds this lock then the hold count</span></span><br><span class="line"><span class="comment">     * is incremented by one and the method returns immediately.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;If the lock is held by another thread then the</span></span><br><span class="line"><span class="comment">     * current thread becomes disabled for thread scheduling</span></span><br><span class="line"><span class="comment">     * purposes and lies dormant until one of two things happens:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;ul&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;The lock is acquired by the current thread; or</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;Some other thread &#123;<span class="doctag">@linkplain</span> Thread#interrupt interrupts&#125; the</span></span><br><span class="line"><span class="comment">     * current thread.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;/ul&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;If the lock is acquired by the current thread then the lock hold</span></span><br><span class="line"><span class="comment">     * count is set to one.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;If the current thread:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;ul&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;has its interrupted status set on entry to this method; or</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;is &#123;<span class="doctag">@linkplain</span> Thread#interrupt interrupted&#125; while acquiring</span></span><br><span class="line"><span class="comment">     * the lock,</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;/ul&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * then &#123;<span class="doctag">@link</span> InterruptedException&#125; is thrown and the current thread&#x27;s</span></span><br><span class="line"><span class="comment">     * interrupted status is cleared.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;In this implementation, as this method is an explicit</span></span><br><span class="line"><span class="comment">     * interruption point, preference is given to responding to the</span></span><br><span class="line"><span class="comment">     * interrupt over normal or reentrant acquisition of the lock.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> InterruptedException if the current thread is interrupted</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">lockInterruptibly</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        sync.acquireInterruptibly(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Acquires the lock only if it is not held by another thread at the time</span></span><br><span class="line"><span class="comment">     * of invocation.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;Acquires the lock if it is not held by another thread and</span></span><br><span class="line"><span class="comment">     * returns immediately with the value &#123;<span class="doctag">@code</span> true&#125;, setting the</span></span><br><span class="line"><span class="comment">     * lock hold count to one. Even when this lock has been set to use a</span></span><br><span class="line"><span class="comment">     * fair ordering policy, a call to &#123;<span class="doctag">@code</span> tryLock()&#125; &lt;em&gt;will&lt;/em&gt;</span></span><br><span class="line"><span class="comment">     * immediately acquire the lock if it is available, whether or not</span></span><br><span class="line"><span class="comment">     * other threads are currently waiting for the lock.</span></span><br><span class="line"><span class="comment">     * This &amp;quot;barging&amp;quot; behavior can be useful in certain</span></span><br><span class="line"><span class="comment">     * circumstances, even though it breaks fairness. If you want to honor</span></span><br><span class="line"><span class="comment">     * the fairness setting for this lock, then use</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@link</span> #tryLock(long, TimeUnit) tryLock(0, TimeUnit.SECONDS) &#125;</span></span><br><span class="line"><span class="comment">     * which is almost equivalent (it also detects interruption).</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;If the current thread already holds this lock then the hold</span></span><br><span class="line"><span class="comment">     * count is incremented by one and the method returns &#123;<span class="doctag">@code</span> true&#125;.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;If the lock is held by another thread then this method will return</span></span><br><span class="line"><span class="comment">     * immediately with the value &#123;<span class="doctag">@code</span> false&#125;.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if the lock was free and was acquired by the</span></span><br><span class="line"><span class="comment">     *         current thread, or the lock was already held by the current</span></span><br><span class="line"><span class="comment">     *         thread; and &#123;<span class="doctag">@code</span> false&#125; otherwise</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">tryLock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sync.nonfairTryAcquire(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Acquires the lock if it is not held by another thread within the given</span></span><br><span class="line"><span class="comment">     * waiting time and the current thread has not been</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@linkplain</span> Thread#interrupt interrupted&#125;.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;Acquires the lock if it is not held by another thread and returns</span></span><br><span class="line"><span class="comment">     * immediately with the value &#123;<span class="doctag">@code</span> true&#125;, setting the lock hold count</span></span><br><span class="line"><span class="comment">     * to one. If this lock has been set to use a fair ordering policy then</span></span><br><span class="line"><span class="comment">     * an available lock &lt;em&gt;will not&lt;/em&gt; be acquired if any other threads</span></span><br><span class="line"><span class="comment">     * are waiting for the lock. This is in contrast to the &#123;<span class="doctag">@link</span> #tryLock()&#125;</span></span><br><span class="line"><span class="comment">     * method. If you want a timed &#123;<span class="doctag">@code</span> tryLock&#125; that does permit barging on</span></span><br><span class="line"><span class="comment">     * a fair lock then combine the timed and un-timed forms together:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  &lt;pre&gt; &#123;<span class="doctag">@code</span></span></span><br><span class="line"><span class="comment">     * if (lock.tryLock() ||</span></span><br><span class="line"><span class="comment">     *     lock.tryLock(timeout, unit)) &#123;</span></span><br><span class="line"><span class="comment">     *   ...</span></span><br><span class="line"><span class="comment">     * &#125;&#125;&lt;/pre&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;If the current thread</span></span><br><span class="line"><span class="comment">     * already holds this lock then the hold count is incremented by one and</span></span><br><span class="line"><span class="comment">     * the method returns &#123;<span class="doctag">@code</span> true&#125;.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;If the lock is held by another thread then the</span></span><br><span class="line"><span class="comment">     * current thread becomes disabled for thread scheduling</span></span><br><span class="line"><span class="comment">     * purposes and lies dormant until one of three things happens:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;ul&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;The lock is acquired by the current thread; or</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;Some other thread &#123;<span class="doctag">@linkplain</span> Thread#interrupt interrupts&#125;</span></span><br><span class="line"><span class="comment">     * the current thread; or</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;The specified waiting time elapses</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;/ul&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;If the lock is acquired then the value &#123;<span class="doctag">@code</span> true&#125; is returned and</span></span><br><span class="line"><span class="comment">     * the lock hold count is set to one.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;If the current thread:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;ul&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;has its interrupted status set on entry to this method; or</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;is &#123;<span class="doctag">@linkplain</span> Thread#interrupt interrupted&#125; while</span></span><br><span class="line"><span class="comment">     * acquiring the lock,</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;/ul&gt;</span></span><br><span class="line"><span class="comment">     * then &#123;<span class="doctag">@link</span> InterruptedException&#125; is thrown and the current thread&#x27;s</span></span><br><span class="line"><span class="comment">     * interrupted status is cleared.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;If the specified waiting time elapses then the value &#123;<span class="doctag">@code</span> false&#125;</span></span><br><span class="line"><span class="comment">     * is returned.  If the time is less than or equal to zero, the method</span></span><br><span class="line"><span class="comment">     * will not wait at all.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;In this implementation, as this method is an explicit</span></span><br><span class="line"><span class="comment">     * interruption point, preference is given to responding to the</span></span><br><span class="line"><span class="comment">     * interrupt over normal or reentrant acquisition of the lock, and</span></span><br><span class="line"><span class="comment">     * over reporting the elapse of the waiting time.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> timeout the time to wait for the lock</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> unit the time unit of the timeout argument</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if the lock was free and was acquired by the</span></span><br><span class="line"><span class="comment">     *         current thread, or the lock was already held by the current</span></span><br><span class="line"><span class="comment">     *         thread; and &#123;<span class="doctag">@code</span> false&#125; if the waiting time elapsed before</span></span><br><span class="line"><span class="comment">     *         the lock could be acquired</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> InterruptedException if the current thread is interrupted</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> NullPointerException if the time unit is null</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">tryLock</span><span class="params">(<span class="keyword">long</span> timeout, TimeUnit unit)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sync.tryAcquireNanos(<span class="number">1</span>, unit.toNanos(timeout));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Attempts to release this lock.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;If the current thread is the holder of this lock then the hold</span></span><br><span class="line"><span class="comment">     * count is decremented.  If the hold count is now zero then the lock</span></span><br><span class="line"><span class="comment">     * is released.  If the current thread is not the holder of this</span></span><br><span class="line"><span class="comment">     * lock then &#123;<span class="doctag">@link</span> IllegalMonitorStateException&#125; is thrown.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalMonitorStateException if the current thread does not</span></span><br><span class="line"><span class="comment">     *         hold this lock</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">unlock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        sync.release(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns a &#123;<span class="doctag">@link</span> Condition&#125; instance for use with this</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@link</span> Lock&#125; instance.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;The returned &#123;<span class="doctag">@link</span> Condition&#125; instance supports the same</span></span><br><span class="line"><span class="comment">     * usages as do the &#123;<span class="doctag">@link</span> Object&#125; monitor methods (&#123;<span class="doctag">@link</span></span></span><br><span class="line"><span class="comment">     * Object#wait() wait&#125;, &#123;<span class="doctag">@link</span> Object#notify notify&#125;, and &#123;<span class="doctag">@link</span></span></span><br><span class="line"><span class="comment">     * Object#notifyAll notifyAll&#125;) when used with the built-in</span></span><br><span class="line"><span class="comment">     * monitor lock.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;ul&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;If this lock is not held when any of the &#123;<span class="doctag">@link</span> Condition&#125;</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@linkplain</span> Condition#await() waiting&#125; or &#123;<span class="doctag">@linkplain</span></span></span><br><span class="line"><span class="comment">     * Condition#signal signalling&#125; methods are called, then an &#123;<span class="doctag">@link</span></span></span><br><span class="line"><span class="comment">     * IllegalMonitorStateException&#125; is thrown.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;When the condition &#123;<span class="doctag">@linkplain</span> Condition#await() waiting&#125;</span></span><br><span class="line"><span class="comment">     * methods are called the lock is released and, before they</span></span><br><span class="line"><span class="comment">     * return, the lock is reacquired and the lock hold count restored</span></span><br><span class="line"><span class="comment">     * to what it was when the method was called.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;If a thread is &#123;<span class="doctag">@linkplain</span> Thread#interrupt interrupted&#125;</span></span><br><span class="line"><span class="comment">     * while waiting then the wait will terminate, an &#123;<span class="doctag">@link</span></span></span><br><span class="line"><span class="comment">     * InterruptedException&#125; will be thrown, and the thread&#x27;s</span></span><br><span class="line"><span class="comment">     * interrupted status will be cleared.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;li&gt; Waiting threads are signalled in FIFO order.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;The ordering of lock reacquisition for threads returning</span></span><br><span class="line"><span class="comment">     * from waiting methods is the same as for threads initially</span></span><br><span class="line"><span class="comment">     * acquiring the lock, which is in the default case not specified,</span></span><br><span class="line"><span class="comment">     * but for &lt;em&gt;fair&lt;/em&gt; locks favors those threads that have been</span></span><br><span class="line"><span class="comment">     * waiting the longest.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;/ul&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the Condition object</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Condition <span class="title">newCondition</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sync.newCondition();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Queries the number of holds on this lock by the current thread.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;A thread has a hold on a lock for each lock action that is not</span></span><br><span class="line"><span class="comment">     * matched by an unlock action.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;The hold count information is typically only used for testing and</span></span><br><span class="line"><span class="comment">     * debugging purposes. For example, if a certain section of code should</span></span><br><span class="line"><span class="comment">     * not be entered with the lock already held then we can assert that</span></span><br><span class="line"><span class="comment">     * fact:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  &lt;pre&gt; &#123;<span class="doctag">@code</span></span></span><br><span class="line"><span class="comment">     * class X &#123;</span></span><br><span class="line"><span class="comment">     *   ReentrantLock lock = new ReentrantLock();</span></span><br><span class="line"><span class="comment">     *   // ...</span></span><br><span class="line"><span class="comment">     *   public void m() &#123;</span></span><br><span class="line"><span class="comment">     *     assert lock.getHoldCount() == 0;</span></span><br><span class="line"><span class="comment">     *     lock.lock();</span></span><br><span class="line"><span class="comment">     *     try &#123;</span></span><br><span class="line"><span class="comment">     *       // ... method body</span></span><br><span class="line"><span class="comment">     *     &#125; finally &#123;</span></span><br><span class="line"><span class="comment">     *       lock.unlock();</span></span><br><span class="line"><span class="comment">     *     &#125;</span></span><br><span class="line"><span class="comment">     *   &#125;</span></span><br><span class="line"><span class="comment">     * &#125;&#125;&lt;/pre&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the number of holds on this lock by the current thread,</span></span><br><span class="line"><span class="comment">     *         or zero if this lock is not held by the current thread</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getHoldCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sync.getHoldCount();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Queries if this lock is held by the current thread.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;Analogous to the &#123;<span class="doctag">@link</span> Thread#holdsLock(Object)&#125; method for</span></span><br><span class="line"><span class="comment">     * built-in monitor locks, this method is typically used for</span></span><br><span class="line"><span class="comment">     * debugging and testing. For example, a method that should only be</span></span><br><span class="line"><span class="comment">     * called while a lock is held can assert that this is the case:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  &lt;pre&gt; &#123;<span class="doctag">@code</span></span></span><br><span class="line"><span class="comment">     * class X &#123;</span></span><br><span class="line"><span class="comment">     *   ReentrantLock lock = new ReentrantLock();</span></span><br><span class="line"><span class="comment">     *   // ...</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *   public void m() &#123;</span></span><br><span class="line"><span class="comment">     *       assert lock.isHeldByCurrentThread();</span></span><br><span class="line"><span class="comment">     *       // ... method body</span></span><br><span class="line"><span class="comment">     *   &#125;</span></span><br><span class="line"><span class="comment">     * &#125;&#125;&lt;/pre&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;It can also be used to ensure that a reentrant lock is used</span></span><br><span class="line"><span class="comment">     * in a non-reentrant manner, for example:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  &lt;pre&gt; &#123;<span class="doctag">@code</span></span></span><br><span class="line"><span class="comment">     * class X &#123;</span></span><br><span class="line"><span class="comment">     *   ReentrantLock lock = new ReentrantLock();</span></span><br><span class="line"><span class="comment">     *   // ...</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *   public void m() &#123;</span></span><br><span class="line"><span class="comment">     *       assert !lock.isHeldByCurrentThread();</span></span><br><span class="line"><span class="comment">     *       lock.lock();</span></span><br><span class="line"><span class="comment">     *       try &#123;</span></span><br><span class="line"><span class="comment">     *           // ... method body</span></span><br><span class="line"><span class="comment">     *       &#125; finally &#123;</span></span><br><span class="line"><span class="comment">     *           lock.unlock();</span></span><br><span class="line"><span class="comment">     *       &#125;</span></span><br><span class="line"><span class="comment">     *   &#125;</span></span><br><span class="line"><span class="comment">     * &#125;&#125;&lt;/pre&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if current thread holds this lock and</span></span><br><span class="line"><span class="comment">     *         &#123;<span class="doctag">@code</span> false&#125; otherwise</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isHeldByCurrentThread</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sync.isHeldExclusively();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Queries if this lock is held by any thread. This method is</span></span><br><span class="line"><span class="comment">     * designed for use in monitoring of the system state,</span></span><br><span class="line"><span class="comment">     * not for synchronization control.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if any thread holds this lock and</span></span><br><span class="line"><span class="comment">     *         &#123;<span class="doctag">@code</span> false&#125; otherwise</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLocked</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sync.isLocked();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns &#123;<span class="doctag">@code</span> true&#125; if this lock has fairness set true.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if this lock has fairness set true</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">isFair</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sync <span class="keyword">instanceof</span> FairSync;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the thread that currently owns this lock, or</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@code</span> null&#125; if not owned. When this method is called by a</span></span><br><span class="line"><span class="comment">     * thread that is not the owner, the return value reflects a</span></span><br><span class="line"><span class="comment">     * best-effort approximation of current lock status. For example,</span></span><br><span class="line"><span class="comment">     * the owner may be momentarily &#123;<span class="doctag">@code</span> null&#125; even if there are</span></span><br><span class="line"><span class="comment">     * threads trying to acquire the lock but have not yet done so.</span></span><br><span class="line"><span class="comment">     * This method is designed to facilitate construction of</span></span><br><span class="line"><span class="comment">     * subclasses that provide more extensive lock monitoring</span></span><br><span class="line"><span class="comment">     * facilities.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the owner, or &#123;<span class="doctag">@code</span> null&#125; if not owned</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Thread <span class="title">getOwner</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sync.getOwner();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Queries whether any threads are waiting to acquire this lock. Note that</span></span><br><span class="line"><span class="comment">     * because cancellations may occur at any time, a &#123;<span class="doctag">@code</span> true&#125;</span></span><br><span class="line"><span class="comment">     * return does not guarantee that any other thread will ever</span></span><br><span class="line"><span class="comment">     * acquire this lock.  This method is designed primarily for use in</span></span><br><span class="line"><span class="comment">     * monitoring of the system state.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if there may be other threads waiting to</span></span><br><span class="line"><span class="comment">     *         acquire the lock</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">hasQueuedThreads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sync.hasQueuedThreads();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Queries whether the given thread is waiting to acquire this</span></span><br><span class="line"><span class="comment">     * lock. Note that because cancellations may occur at any time, a</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@code</span> true&#125; return does not guarantee that this thread</span></span><br><span class="line"><span class="comment">     * will ever acquire this lock.  This method is designed primarily for use</span></span><br><span class="line"><span class="comment">     * in monitoring of the system state.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> thread the thread</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if the given thread is queued waiting for this lock</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> NullPointerException if the thread is null</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">hasQueuedThread</span><span class="params">(Thread thread)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sync.isQueued(thread);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns an estimate of the number of threads waiting to</span></span><br><span class="line"><span class="comment">     * acquire this lock.  The value is only an estimate because the number of</span></span><br><span class="line"><span class="comment">     * threads may change dynamically while this method traverses</span></span><br><span class="line"><span class="comment">     * internal data structures.  This method is designed for use in</span></span><br><span class="line"><span class="comment">     * monitoring of the system state, not for synchronization</span></span><br><span class="line"><span class="comment">     * control.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the estimated number of threads waiting for this lock</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">getQueueLength</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sync.getQueueLength();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns a collection containing threads that may be waiting to</span></span><br><span class="line"><span class="comment">     * acquire this lock.  Because the actual set of threads may change</span></span><br><span class="line"><span class="comment">     * dynamically while constructing this result, the returned</span></span><br><span class="line"><span class="comment">     * collection is only a best-effort estimate.  The elements of the</span></span><br><span class="line"><span class="comment">     * returned collection are in no particular order.  This method is</span></span><br><span class="line"><span class="comment">     * designed to facilitate construction of subclasses that provide</span></span><br><span class="line"><span class="comment">     * more extensive monitoring facilities.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the collection of threads</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Collection&lt;Thread&gt; <span class="title">getQueuedThreads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sync.getQueuedThreads();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Queries whether any threads are waiting on the given condition</span></span><br><span class="line"><span class="comment">     * associated with this lock. Note that because timeouts and</span></span><br><span class="line"><span class="comment">     * interrupts may occur at any time, a &#123;<span class="doctag">@code</span> true&#125; return does</span></span><br><span class="line"><span class="comment">     * not guarantee that a future &#123;<span class="doctag">@code</span> signal&#125; will awaken any</span></span><br><span class="line"><span class="comment">     * threads.  This method is designed primarily for use in</span></span><br><span class="line"><span class="comment">     * monitoring of the system state.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> condition the condition</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if there are any waiting threads</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalMonitorStateException if this lock is not held</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalArgumentException if the given condition is</span></span><br><span class="line"><span class="comment">     *         not associated with this lock</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> NullPointerException if the condition is null</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasWaiters</span><span class="params">(Condition condition)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (condition == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">        <span class="keyword">if</span> (!(condition <span class="keyword">instanceof</span> AbstractQueuedSynchronizer.ConditionObject))</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;not owner&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> sync.hasWaiters((AbstractQueuedSynchronizer.ConditionObject)condition);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns an estimate of the number of threads waiting on the</span></span><br><span class="line"><span class="comment">     * given condition associated with this lock. Note that because</span></span><br><span class="line"><span class="comment">     * timeouts and interrupts may occur at any time, the estimate</span></span><br><span class="line"><span class="comment">     * serves only as an upper bound on the actual number of waiters.</span></span><br><span class="line"><span class="comment">     * This method is designed for use in monitoring of the system</span></span><br><span class="line"><span class="comment">     * state, not for synchronization control.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> condition the condition</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the estimated number of waiting threads</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalMonitorStateException if this lock is not held</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalArgumentException if the given condition is</span></span><br><span class="line"><span class="comment">     *         not associated with this lock</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> NullPointerException if the condition is null</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getWaitQueueLength</span><span class="params">(Condition condition)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (condition == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">        <span class="keyword">if</span> (!(condition <span class="keyword">instanceof</span> AbstractQueuedSynchronizer.ConditionObject))</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;not owner&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> sync.getWaitQueueLength((AbstractQueuedSynchronizer.ConditionObject)condition);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns a collection containing those threads that may be</span></span><br><span class="line"><span class="comment">     * waiting on the given condition associated with this lock.</span></span><br><span class="line"><span class="comment">     * Because the actual set of threads may change dynamically while</span></span><br><span class="line"><span class="comment">     * constructing this result, the returned collection is only a</span></span><br><span class="line"><span class="comment">     * best-effort estimate. The elements of the returned collection</span></span><br><span class="line"><span class="comment">     * are in no particular order.  This method is designed to</span></span><br><span class="line"><span class="comment">     * facilitate construction of subclasses that provide more</span></span><br><span class="line"><span class="comment">     * extensive condition monitoring facilities.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> condition the condition</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the collection of threads</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalMonitorStateException if this lock is not held</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalArgumentException if the given condition is</span></span><br><span class="line"><span class="comment">     *         not associated with this lock</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> NullPointerException if the condition is null</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Collection&lt;Thread&gt; <span class="title">getWaitingThreads</span><span class="params">(Condition condition)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (condition == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">        <span class="keyword">if</span> (!(condition <span class="keyword">instanceof</span> AbstractQueuedSynchronizer.ConditionObject))</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;not owner&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> sync.getWaitingThreads((AbstractQueuedSynchronizer.ConditionObject)condition);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns a string identifying this lock, as well as its lock state.</span></span><br><span class="line"><span class="comment">     * The state, in brackets, includes either the String &#123;<span class="doctag">@code</span> &quot;Unlocked&quot;&#125;</span></span><br><span class="line"><span class="comment">     * or the String &#123;<span class="doctag">@code</span> &quot;Locked by&quot;&#125; followed by the</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@linkplain</span> Thread#getName name&#125; of the owning thread.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> a string identifying this lock, as well as its lock state</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Thread o = sync.getOwner();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.toString() + ((o == <span class="keyword">null</span>) ?</span><br><span class="line">                                   <span class="string">&quot;[Unlocked]&quot;</span> :</span><br><span class="line">                                   <span class="string">&quot;[Locked by thread &quot;</span> + o.getName() + <span class="string">&quot;]&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>贴一下结构图，然后逐一分析</p>
<img src="/java-sourcecode-reentrantlock/image-20210422203838938.png" class="" title="image-20210422203838938">

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-04-18T14:44:19.000Z" title="2021/4/18 22:44:19">2021-04-18</time>发表</span><span class="level-item"><time dateTime="2021-04-22T08:16:34.000Z" title="2021/4/22 16:16:34">2021-04-22</time>更新</span><span class="level-item">几秒读完 (大约46个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/java-utils-menu/">java递归生成菜单</a></h1><div class="content"><p>记录java递归生成菜单</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">List&lt;Menu&gt;menuList=dao.selectMenu();</span><br><span class="line"></span><br><span class="line">List&lt;Menu&gt;newMenu=buildMenuTree(menuList,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> List&lt;Menu&gt; <span class="title">buildMenuTree</span><span class="params">(List&lt;Menu&gt; menuList, Integer pid)</span> </span>&#123;</span><br><span class="line">        List&lt;Menu&gt; treeList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        menuList.forEach(menu -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (menu.getParentId().equals(pid)) &#123;</span><br><span class="line">                menu.setChildrens(buildMenuTree(menuList, menu.getId()));</span><br><span class="line">                treeList.add(menu);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> treeList;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-04-15T07:46:44.000Z" title="2021/4/15 15:46:44">2021-04-15</time>发表</span><span class="level-item"><time dateTime="2021-04-22T08:19:53.000Z" title="2021/4/22 16:19:53">2021-04-22</time>更新</span><span class="level-item">几秒读完 (大约64个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/java-utils-difftime/">java计算两个时间之间相差月份</a></h1><div class="content"><p>记录一下java计算两个时间相差的月份</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Integer <span class="title">getDifMonth</span><span class="params">(Date startDate, Date endDate)</span></span>&#123;</span><br><span class="line">        Calendar start = Calendar.getInstance();</span><br><span class="line">        Calendar end = Calendar.getInstance();</span><br><span class="line">        start.setTime(startDate);</span><br><span class="line">        end.setTime(endDate);</span><br><span class="line">        <span class="keyword">int</span> result = end.get(Calendar.MONTH) - start.get(Calendar.MONTH);</span><br><span class="line">        <span class="keyword">int</span> month = (end.get(Calendar.YEAR) - start.get(Calendar.YEAR)) * <span class="number">12</span>;</span><br><span class="line">        <span class="keyword">return</span> Math.abs(month + result);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-04-14T05:49:57.000Z" title="2021/4/14 13:49:57">2021-04-14</time>发表</span><span class="level-item"><time dateTime="2021-08-18T14:24:09.769Z" title="2021/8/18 22:24:09">2021-08-18</time>更新</span><span class="level-item">28 分钟读完 (大约4132个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/docker-command/">docker基本命令</a></h1><div class="content"><p>本文将介绍一些docker中的命令与目前过程中的一些技巧,这是自己在学习过程中的一些积累，记录下来，方便查询。</p></div><a class="article-more button is-small is-size-7" href="/docker-command/#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-04-14T02:08:26.000Z" title="2021/4/14 10:08:26">2021-04-14</time>发表</span><span class="level-item"><time dateTime="2021-04-22T08:16:34.000Z" title="2021/4/22 16:16:34">2021-04-22</time>更新</span><span class="level-item">3 分钟读完 (大约438个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/tool-docker-docker-install/">docker简介及安装</a></h1><div class="content"><h2 id="什么是docker"><a href="#什么是docker" class="headerlink" title="什么是docker"></a>什么是docker</h2><p>Docker 是一个开源的应用容器引擎，基于 Go 语言并遵从 Apache2.0 协议开源。</p>
<p>Docker 可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。</p>
<p>容器是完全使用沙箱机制，相互之间不会有任何接口（类似 iPhone 的 app）,更重要的是容器性能开销极低。</p></div><a class="article-more button is-small is-size-7" href="/tool-docker-docker-install/#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-04-14T01:17:48.000Z" title="2021/4/14 09:17:48">2021-04-14</time>发表</span><span class="level-item"><time dateTime="2021-05-01T23:26:12.000Z" title="2021/5/2 07:26:12">2021-05-02</time>更新</span><span class="level-item">4 分钟读完 (大约559个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/bigdata-hive1/">hive简介及安装</a></h1><div class="content"><p>hive是基于Hadoop的一个数据仓库工具，用来进行数据提取、转化、加载，这是一种可以存储、查询和分析存储在Hadoop中的大规模数据的机制。hive数据仓库工具能将结构化的数据文件映射为一张数据库表，并提供SQL查询功能，能将SQL语句转变成MapReduce任务来执行。Hive的优点是学习成本低，可以通过类似SQL语句实现快速MapReduce统计，使MapReduce变得更加简单，而不必开发专门的MapReduce应用程序。hive十分适合对数据仓库进行统计分析。</p></div><a class="article-more button is-small is-size-7" href="/bigdata-hive1/#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-03-30T05:17:34.000Z" title="2021/3/30 13:17:34">2021-03-30</time>发表</span><span class="level-item"><time dateTime="2021-03-30T05:17:34.000Z" title="2021/3/30 13:17:34">2021-03-30</time>更新</span><span class="level-item">12 分钟读完 (大约1769个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/undefined/"> </a></h1><div class="content"><h1 id="MySql数据库的知识总结"><a href="#MySql数据库的知识总结" class="headerlink" title="MySql数据库的知识总结"></a>MySql数据库的知识总结</h1><h2 id="1-mysql数据库常用的存储引擎"><a href="#1-mysql数据库常用的存储引擎" class="headerlink" title="1. mysql数据库常用的存储引擎"></a>1. mysql数据库常用的存储引擎</h2><p>MyISAM、InnoDB、MERGE、MEMORY(HEAP)、BDB(BerkeleyDB)、EXAMPLE、FEDERATED、ARCHIVE、CSV、BLACKHOLE。</p>
<h2 id="2-MyISAM-和InnoDB的区别"><a href="#2-MyISAM-和InnoDB的区别" class="headerlink" title="2. MyISAM 和InnoDB的区别"></a>2. MyISAM 和InnoDB的区别</h2><img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210324102037337.png" alt="image-20210324102037337" style="zoom:50%;" />

<h2 id="3-mysql-的架构图"><a href="#3-mysql-的架构图" class="headerlink" title="3. mysql 的架构图"></a>3. mysql 的架构图</h2><img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210324101741686.png" alt="image-20210324101741686" style="zoom:50%;" />

<p>特点：可插拔式</p>
<h2 id="4-Mysql-索引"><a href="#4-Mysql-索引" class="headerlink" title="4. Mysql 索引"></a>4. Mysql 索引</h2><h3 id="导致性能下降的原因有"><a href="#导致性能下降的原因有" class="headerlink" title="导致性能下降的原因有"></a>导致性能下降的原因有</h3><ol>
<li><p>查询磁盘问题  top</p>
</li>
<li><p>sql写的烂</p>
</li>
<li><p>索引失效(单值索引、复合索引)</p>
<p>id name email weixinNumber</p>
<p>单值索引</p>
<p>create index idx_user_name on user(name);</p>
<p>复合索引</p>
<p>create index idx_user_name_email on user(name,email);</p>
</li>
<li><p>关联查询太多join（设计缺陷）</p>
</li>
<li><p>服务器调优及各个参数设置</p>
</li>
</ol>
<h3 id="常见的join查询"><a href="#常见的join查询" class="headerlink" title="常见的join查询"></a>常见的join查询</h3><img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210324103152493.png" alt="image-20210324103152493" style="zoom:50%;" />

<img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210324103248647.png" alt="image-20210324103248647" style="zoom:50%;" />

<h3 id="七种join理论"><a href="#七种join理论" class="headerlink" title="七种join理论"></a>七种join理论</h3><img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210324105825223.png" alt="image-20210324105825223" style="zoom:50%;" />

<h3 id="索引是什么？"><a href="#索引是什么？" class="headerlink" title="索引是什么？"></a>索引是什么？</h3><p>Mysql官方的定义为索引（Index）是帮助MySql高效获取数据的数据结构，本质就是数据结构</p>
<p>索引的目的就是为了提高查询效率，类似于字典</p>
<h3 id="索引的创建方式"><a href="#索引的创建方式" class="headerlink" title="索引的创建方式"></a>索引的创建方式</h3><p>  主键</p>
<p>  alter table tableName add primary key(column_list);</p>
<p>  唯一索引</p>
<p>  alter table tableName add unique index index_name(column_list);</p>
<p>  普通索引</p>
<p>  alter table tableName add index index_name(column_list);</p>
<p>  全文索引</p>
<p>  alter table tableName add fullText index_name index_name(column_list);</p>
<h3 id="哪些字段适合创建索引？"><a href="#哪些字段适合创建索引？" class="headerlink" title="哪些字段适合创建索引？"></a>哪些字段适合创建索引？</h3><p>主键自动创建索引<br>频繁作为查询条件的应该作为索引<br>查询中与其他表关联的字段<br>大部分情况下选择组合索引<br>查询中排序的字段<br>查询中统计或者分组的字段</p>
<h3 id="哪些情况不适合建索引"><a href="#哪些情况不适合建索引" class="headerlink" title="哪些情况不适合建索引"></a>哪些情况不适合建索引</h3><p>表记录太少   300万<br>经常增删改的列<br>数据重复且分布平均的字段</p>
<img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210325173119006.png" alt="image-20210325173119006" style="zoom:50%;" />

<h3 id="索引的类型"><a href="#索引的类型" class="headerlink" title="索引的类型"></a>索引的类型</h3><p>聚集索引、非聚集索引、聚簇索引、稀疏索引、稠密索引</p>
<h4 id="聚集索引"><a href="#聚集索引" class="headerlink" title="聚集索引"></a>聚集索引</h4><h4 id="非聚集索引"><a href="#非聚集索引" class="headerlink" title="非聚集索引"></a>非聚集索引</h4><h4 id="聚簇索引"><a href="#聚簇索引" class="headerlink" title="聚簇索引"></a>聚簇索引</h4><h4 id="稀疏索引"><a href="#稀疏索引" class="headerlink" title="稀疏索引"></a>稀疏索引</h4><h4 id="稠密索引"><a href="#稠密索引" class="headerlink" title="稠密索引"></a>稠密索引</h4><h2 id="5-mysql-性能分析explain关键字"><a href="#5-mysql-性能分析explain关键字" class="headerlink" title="5. mysql 性能分析explain关键字"></a>5. mysql 性能分析explain关键字</h2><ol>
<li><p>能干嘛</p>
<p>表的读取顺序</p>
<p>数据读取的读取操作类型</p>
<p>哪些索引可以被使用</p>
<p>哪些索引实际被使用</p>
<p>表之间的引用</p>
<p>每张表有多少行被优化器查询</p>
<img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210325180332331.png" alt="image-20210325180332331" style="zoom:50%;" />

<img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210325180416947.png" alt="image-20210325180416947" style="zoom:50%;" /></li>
<li><p>id 介绍</p>
<p>谁的顺序高，谁先执行，如果相同则从上到下执行</p>
</li>
<li><p>select_type介绍</p>
<p>simple：简单的select查询，不包含子查询或者union</p>
<p>primary：查询中包含复杂的子部分，最外层被标记为</p>
<p>subquery：在select 或者where列表中包含子查询</p>
<p>derived：临时表</p>
<p>union：若第二个select出现在union之后，被标记为union，若union包含在from子句的子查询中，外层select奖杯标记为derived</p>
<p>union result：从union表获取结果的select。</p>
</li>
<li><p>type介绍</p>
<p>all：     全表扫描</p>
<p>index：全索引扫描</p>
<p>range：只检索给定范围内的检索</p>
<p>ref：非唯一性索引扫描，返回匹配某个单独值的所有行。本质上也是一种索引访问，他返回所有匹配某个单独值的行。</p>
<p>eq_ref：唯一性索引扫描，对于每个索引建，表中只有一条记录与之匹配，常见主键或者唯一索引扫描</p>
<p>const：表示通过索引一次就找到了，const用于比较primary key 或者unique索引。因为只匹配一行数据，所以很快。</p>
<p>system ：表只有一行数据，const类型的特例，平时不会出现。</p>
<p>null</p>
</li>
</ol>
<p>  从好到差依次为：system&gt;const&gt;eq_ref&gt;ref&gt;range&gt;index&gt;all</p>
<ol start="5">
<li>possible_keys key key_len</li>
</ol>
<p>possible_keys:显示可能应用到这张表中的索引，一个或多个，查询涉及到的字段上若存在索引，则该索引将被列出，但不一定被查询使用</p>
<p>key：实际使用的索引</p>
<p>key_len:表示索引中使用的字节数，可通过该列计算查询中使用的索引的长度，在不损失精确性的情况下，长度越短越好</p>
<ol start="6">
<li>rows 介绍</li>
</ol>
<p>根据表统计信息及索引选用情况，大致估算出找出所需的记录所需要读取的行数。</p>
<ol start="7">
<li><p>extra介绍</p>
<p>Using filesort：文件内排序</p>
<p>using temporary：使用临时表</p>
<p>using index：表示不错</p>
</li>
</ol>
<h2 id="6-索引优化及失效的情况"><a href="#6-索引优化及失效的情况" class="headerlink" title="6.索引优化及失效的情况"></a>6.索引优化及失效的情况</h2><img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210326101743536.png" alt="image-20210326101743536" style="zoom:50%;" />

<p>最佳左前缀法则：1.带头大哥不能死2.中间兄弟不能断</p>
<img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210326133458510.png" alt="image-20210326133458510" style="zoom:50%;" />

<p>==小表驱动大表==</p>
<p>Exists 或者in 的使用</p>
<p>如果 A小于b 则用 in</p>
<p>select * from a where id=(select id from b)</p>
<p>如果 a表的数据集大约b，则用exists</p>
<p>select * from a where exists (select 1 from b where a.id=b.id)</p>
<p>==为排序增加索引==</p>
<img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210326155852987.png" alt="image-20210326155852987" style="zoom:50%;" />







<h2 id="7-实际过程中分析sql"><a href="#7-实际过程中分析sql" class="headerlink" title="7.实际过程中分析sql"></a>7.实际过程中分析sql</h2><ol>
<li><p>观察，至少跑一天，查看生产环境的慢sql</p>
</li>
<li><p>开启慢查询日志</p>
</li>
<li><p>explain+慢sql分析</p>
</li>
<li><p>show profile</p>
</li>
<li><p>运维经理或者dba性能调优</p>
</li>
</ol>
<h2 id="8-慢sql日志查询"><a href="#8-慢sql日志查询" class="headerlink" title="8. 慢sql日志查询"></a>8. 慢sql日志查询</h2><p>  默认mysql数据库没有开启慢查询日志</p>
<p>配置一下</p>
<p>借助 mysqldumpslow去查看</p>
<img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210326212257952.png" alt="image-20210326212257952" style="zoom:50%;" />

<img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210326212349462.png" alt="image-20210326212349462" style="zoom:50%;" />

<h2 id="9-Show-profiles-使用（记录曾经执行过的sql）"><a href="#9-Show-profiles-使用（记录曾经执行过的sql）" class="headerlink" title="9. Show profiles 使用（记录曾经执行过的sql）"></a>9. Show profiles 使用（记录曾经执行过的sql）</h2><p>使用步骤</p>
<ol>
<li><p>查询profiles 状态</p>
<p>show VARIABLES like ‘profiling%’</p>
<img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210329091508015.png" alt="image-20210329091508015" style="zoom:50%;" /></li>
<li><p>开启profiles</p>
<p>set profiling=on;(已经开启过的可以不开启)</p>
</li>
<li><p>show profiles; </p>
</li>
</ol>
<p>查询曾经使用过的sql</p>
<img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210329085942082.png" alt="image-20210329085942082" style="zoom:50%;" />

<ol start="4">
<li><p>show profile cpu,block io for query **(Query_id);</p>
<img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210329091856611.png" alt="image-20210329091856611" style="zoom:50%;" />

<ol start="5">
<li><p>结论</p>
<img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210329110501104.png" alt="image-20210329110501104" style="zoom:50%;" /></li>
</ol>
</li>
</ol>
<p>如果sql中出现这4个问题，则表示问题有点大</p>
<h2 id="10-全局查询日志"><a href="#10-全局查询日志" class="headerlink" title="10.全局查询日志"></a>10.全局查询日志</h2><p>==永远不用在生产环境启用这个功能==</p>
<p>set global general_log =1;</p>
<p>Set global log_output=’TABLE’;</p>
<p>select * from mysql.general_log</p>
<h2 id="11-Mysql锁机制-MyIsam"><a href="#11-Mysql锁机制-MyIsam" class="headerlink" title="11.Mysql锁机制(MyIsam)"></a>11.Mysql锁机制(MyIsam)</h2><p>查看锁的状态</p>
<p>   show open tables;  </p>
<p>   unlock tables;</p>
<p>按照锁的类型来分</p>
<ul>
<li><p>读锁（共享锁）</p>
<p>命令 lock table * read;</p>
<p>加上读锁，自己能写这个表，不能读写其他表，不能update这个表</p>
<p>其他 能读 不能写（死锁）</p>
</li>
<li><p>写锁（排他锁）</p>
<p>命令 lock table * write;</p>
<img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210329154023885.png" alt="image-20210329154023885" style="zoom:50%;" />

<img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210329155557747.png" alt="image-20210329155557747" style="zoom:50%;" />

<p>下面的table locks waited 越高，证明性能越不好。</p>
</li>
</ul>
<h2 id="12-mysql-事务"><a href="#12-mysql-事务" class="headerlink" title="12. mysql 事务"></a>12. mysql 事务</h2><img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210329155829159.png" alt="image-20210329155829159" style="zoom:50%;" />

<h2 id="13-mysql-事务隔离级别"><a href="#13-mysql-事务隔离级别" class="headerlink" title="13. mysql  事务隔离级别"></a>13. mysql  事务隔离级别</h2><img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210329160118303.png" alt="image-20210329160118303" style="zoom:50%;" />

<h2 id="14-mysql-行锁"><a href="#14-mysql-行锁" class="headerlink" title="14. mysql 行锁"></a>14. mysql 行锁</h2><h2 id="15-索引操作不当，行锁变成表锁"><a href="#15-索引操作不当，行锁变成表锁" class="headerlink" title="15. 索引操作不当，行锁变成表锁"></a>15. 索引操作不当，行锁变成表锁</h2><h2 id="16-间隙锁"><a href="#16-间隙锁" class="headerlink" title="16. 间隙锁"></a>16. 间隙锁</h2><img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210329223734308.png" alt="image-20210329223734308" style="zoom:50%;" />

<h2 id="17-如何锁定一行？"><a href="#17-如何锁定一行？" class="headerlink" title="17. 如何锁定一行？"></a>17. 如何锁定一行？</h2><p>for update</p>
<h2 id="18-性能总结"><a href="#18-性能总结" class="headerlink" title="18 性能总结"></a>18 性能总结</h2><p>​    <img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210329225912024.png" alt="image-20210329225912024" style="zoom:50%;" /></p>
<h2 id="19-mysql-主从复制"><a href="#19-mysql-主从复制" class="headerlink" title="19 mysql 主从复制"></a>19 mysql 主从复制</h2><blockquote>
<p>原理</p>
</blockquote>
<p>slave会从master读取binlog日志来进行同步。</p>
<blockquote>
<p> 三步骤+原理图</p>
</blockquote>
  <img src="/Users/mrhy/Library/Application Support/typora-user-images/image-20210330090221517.png" alt="image-20210330090221517" style="zoom:50%;" />

<blockquote>
<p> 步骤</p>
</blockquote>
<ol>
<li><p>修改主机配置文件</p>
<p>server-id=1;</p>
<p>log-bin=自己本地路径/mysqlin</p>
</li>
<li><p>从机修改id</p>
<p>server-id=2;</p>
<p>log-bin=mysql-bin</p>
</li>
<li><p>重启服务</p>
</li>
<li><p>主机授权</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">grant</span> replication slave, replication client <span class="keyword">on</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;rep&#x27;</span>@<span class="string">&#x27;192.168.159.%&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;Mysql@123&#x27;</span>;</span><br><span class="line">flush privileges</span><br></pre></td></tr></table></figure></li>
<li><p>查看主机状态</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> master status;</span><br></pre></td></tr></table></figure></li>
<li><p>从机配置</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">CHANGE MASTER <span class="keyword">TO</span> </span><br><span class="line">MASTER_HOST<span class="operator">=</span><span class="string">&#x27;172.16.1.52&#x27;</span>,  #这是主库的IP（域名也可以需要做解析）</span><br><span class="line">MASTER_PORT<span class="operator">=</span><span class="number">3306</span>,              #主库的端口，从库端口和主库不可以相同</span><br><span class="line">MASTER_USER<span class="operator">=</span><span class="string">&#x27;rep&#x27;</span>,            #这是主库上创建用来复制的用户rep</span><br><span class="line">MASTER_PASSWORD<span class="operator">=</span><span class="string">&#x27;123456&#x27;</span>    #rep的密码</span><br><span class="line">MASTER_LOG_FILE<span class="operator">=</span><span class="string">&#x27;mysql-bin.000025&#x27;</span>, #这里是<span class="keyword">show</span> master</span><br><span class="line">status时看到的查询二进制日志文件名称，这里不能多空格</span><br><span class="line">MASTER_LOG_POS<span class="operator">=</span><span class="number">9155</span>;       #这里是<span class="keyword">show</span> master status时看到的二进制日志偏移量，不能多空格</span><br></pre></td></tr></table></figure></li>
<li><p>开启从机复制</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">start</span> slave ;</span><br></pre></td></tr></table></figure></li>
<li><p>查看从机状态</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> slave status\G</span><br></pre></td></tr></table></figure>

<p>如果Slave_IO_RUNING:YES 和 SLAVE_SQL_RUNING:YES 则证明配置成功;</p>
</li>
<li><p>停从机<br> stop slave;</p>
</li>
</ol>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/9/">上一页</a></div><div class="pagination-next"><a href="/page/11/">下一页</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/9/">9</a></li><li><a class="pagination-link is-current" href="/page/10/">10</a></li><li><a class="pagination-link" href="/page/11/">11</a></li><li><a class="pagination-link" href="/page/12/">12</a></li><li><a class="pagination-link" href="/page/13/">13</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-10-26T09:50:26.000Z">2022-10-26</time></p><p class="title"><a href="/jvm-runing-area/">jvm运行时数据区</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-10-21T07:26:53.000Z">2022-10-21</time></p><p class="title"><a href="/jvm-load/">jvm类加载的过程</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-10-18T03:32:51.000Z">2022-10-18</time></p><p class="title"><a href="/descartes/">笛卡尔积工具类</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-09-09T06:13:13.000Z">2022-09-09</time></p><p class="title"><a href="/SpringBootApplication/">Springboot启动源码分析</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-07-18T05:43:10.000Z">2022-07-18</time></p><p class="title"><a href="/k8s-api/">k8s的API</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/10/"><span class="level-start"><span class="level-item">十月 2022</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/09/"><span class="level-start"><span class="level-item">九月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">七月 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/06/"><span class="level-start"><span class="level-item">六月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">四月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">二月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">一月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">十一月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">十月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/09/"><span class="level-start"><span class="level-item">九月 2021</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">八月 2021</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">七月 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">六月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">五月 2021</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">四月 2021</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/03/"><span class="level-start"><span class="level-item">三月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">一月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/12/"><span class="level-start"><span class="level-item">十二月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">十一月 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/10/"><span class="level-start"><span class="level-item">十月 2020</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/09/"><span class="level-start"><span class="level-item">九月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/JVM/"><span class="tag">JVM</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/architect/"><span class="tag">architect</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clickhouse/"><span class="tag">clickhouse</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/es/"><span class="tag">es</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flink/"><span class="tag">flink</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java/"><span class="tag">java</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jenkins/"><span class="tag">jenkins</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jvm/"><span class="tag">jvm</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/k8s/"><span class="tag">k8s</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kafka/"><span class="tag">kafka</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux/"><span class="tag">linux</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/log4j2/"><span class="tag">log4j2</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mysql/"><span class="tag">mysql</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/prometheus/"><span class="tag">prometheus</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/redis/"><span class="tag">redis</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spring/"><span class="tag">spring</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%89%91%E6%8C%87offer/"><span class="tag">剑指offer</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/"><span class="tag">基础知识点</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/"><span class="tag">大数据</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B7%A5%E5%85%B7/"><span class="tag">工具</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"><span class="tag">微服务</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/"><span class="tag">排序算法</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%BA%90%E7%A0%81/"><span class="tag">源码</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%AE%97%E6%B3%95/"><span class="tag">算法</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BA%BF%E4%B8%8A%E9%97%AE%E9%A2%98/"><span class="tag">线上问题</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="tag">设计模式</span><span class="tag">16</span></a></div></div></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://octodex.github.com/images/daftpunktocat-thomas.gif" alt="mrhy1996"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">mrhy1996</p><p class="is-size-6 is-block">立志登山揽月</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国 · 上海</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">89</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">27</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/Mrhy1996/" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Mrhy1996"><i class="fab fa-github"></i></a></div></div></div><!--!--></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="mrhy&#039;s blogs" height="28"></a><p class="is-size-7"><span>&copy; 2022 mrhy</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>